<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Auto-Suggest</title>
    <style>
      
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .autocomplete {
            position: relative;
            display: inline-block;
        }
        .autocomplete-items {
            position: absolute;
            border: 1px solid #ddd;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
        }
        .autocomplete-item {
            padding: 10px;
            cursor: pointer;
            background-color: #fff;
        }
        .autocomplete-item:hover {
            background-color: #ddd;
        }
        .input-container {
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <h1>Address Auto-Suggest</h1>
    <div class="autocomplete">
        <div class="input-container">
            <label for="city-input">City:</label>
            <input id="city-input" type="text" placeholder="City">
        </div>
        <div class="input-container">
            <label for="street-input">Street:</label>
            <input id="street-input" type="text" placeholder="Street">
        </div>
        <div class="input-container">
            <label for="zip-input">ZIP Code:</label>
            <input id="zip-input" type="text" placeholder="ZIP Code">
        </div>
        <div id="autocomplete-list" class="autocomplete-items"></div>
    </div>

    <!-- Mapbox JavaScript API -->
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.8.1/mapbox-gl.js"></script>
    <script>
        const accessToken = 'pk.eyJ1IjoiaGljMjAyNCIsImEiOiJjbHloM2Z1N3QwMGU2MmlyNTk4a3ZkeG8zIn0.mL9YUF_i7BdV8fy3b0gNnw'; // Replace with your Mapbox access token

        const inputs = ['city-input', 'street-input', 'zip-input'];

        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                const value = this.value;
                if (value.length < 2) { // Fetch suggestions only if the input is at least 2 characters
                    closeAllLists();
                    return;
                }
                fetchSuggestions(value);
            });
        });

        function fetchSuggestions(query) {
            fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(query)}.json?access_token=${accessToken}`)
                .then(response => response.json())
                .then(data => {
                    const suggestions = data.features;
                    showSuggestions(suggestions);
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        function showSuggestions(suggestions) {
            const listContainer = document.getElementById('autocomplete-list');
            listContainer.innerHTML = '';

            suggestions.forEach(suggestion => {
                const item = document.createElement('div');
                item.classList.add('autocomplete-item');
                item.innerHTML = `<strong>${suggestion.text}</strong>`;
                item.addEventListener('click', () => {
                    fillAddressFields(suggestion);
                    closeAllLists();
                });
                listContainer.appendChild(item);
            });
        }

        function fillAddressFields(suggestion) {
            const address = suggestion.place_name;
            const parts = address.split(', ');
            const street = parts[0] || '';
            const zip = parts[parts.length - 2] || ''; // ZIP is usually second last in a US address

            document.getElementById('city-input').value = suggestion.text;
            document.getElementById('street-input').value = street;
            document.getElementById('zip-input').value = zip;
        }

        function closeAllLists() {
            document.getElementById('autocomplete-list').innerHTML = '';
        }

        document.addEventListener('click', function(e) {
            if (!e.target.matches('#city-input, #street-input, #zip-input')) {
                closeAllLists();
            }
        });

    </script>
</body>
</html>
