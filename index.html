
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
    <title>WebToLead</title>
    <style>
        *{
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        .wrapper{
            display: flex;
            justify-content: center;
            background-color:rgba(142,136,50,0.14);
            position: relative;
          	width :auto;
         	 	height: auto;
            border-radius: 25px;
        }
        .formcls{
            display: flex;
            flex-direction: column;
            background-color:transparent;
            gap: 1rem;
            width: 75vw;
            height: auto;
            margin-top:35px;
            margin-bottom:35px;
            margin-left:50px;
            margin-right:50px;
        }    

        .formWrapper{
            margin-top: 15px;
            background-color: transparent;
            display: grid;
            gap: 2.3rem;
            grid-template-columns: auto auto;
          
        }
        @media screen and (max-width: 550px){
            .formWrapper{
                margin-top: 15px;
                background-color: transparent;
                display:flex;
                flex-direction:column;
                gap: 2.3rem;
                grid-template-columns: auto auto;
              
            }
        }
        .submit{
            display: flex;
            background-color: transparent;
            flex-direction: row;
            justify-content: space-between;
        }
        @media screen and (max-width: 550px){
            .submit{
                display: flex;
                background-color: transparent;
                gap:1rem;
                flex-direction: column;
                justify-content: space-between;
            }
        }
      .g-recaptcha{
       transform:scale(0.88);
       transform-origin:0 0;
      }
        .inptcls{
             padding:15px;
             border: 1px solid black;
             border-radius:10px;
             height:50px;
        }
      .businessname{
        margin-top:15px;
      }
      
      .notes{
         margin-top:15px;
      }

        .error-message {
            color: red;
            font-weight: bold;
            margin-top: 2px;
        }
        .subBtn:hover{
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="wrapper">
       <form class="formcls" id="leadForm" action="https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8&orgId=00DHp000003USyC" method="POST" onsubmit="return webToLead(event)">
        <input type=hidden name="oid" value="00DHp000003USyC">
<!--       please insure your keyname for recaptcha in your org [web to lead ]  -->
        <input type=hidden name='captcha_settings' value='{"keyname":"WebToLeadKeyPairs","fallback":"true","orgId":"00DHp000003USyC","ts":""}' required>
<!--       after form submission you can change return url as you want -->
        <input type=hidden name="retURL" value="https://wire.kajcreativeweb.com/thank-you/">
          <div class="formWrapper">
              <input class="inptcls" id="firstName" placeholder="First Name"  name="first_name" type="text" style=" background-color: transparent; padding-left: 24px;          
             border: 1px solid black; border-left:5px solid red;color:black;" required />
              <input class="inptcls" id="lastName" placeholder="Last Name" name="last_name" style=" background-color: transparent; padding-left: 24px;          
             border: 1px solid black;border-left:5px solid red;color:black;" type="text" required />
              <input class="inptcls" id="email" placeholder="Email" type="email" name="email" style=" background-color: transparent;  padding-left: 24px;         
             border: 1px solid black;border-left:5px solid red;color:black;" required />
              <input class="inptcls" id="phone" placeholder="Phone" name="phone" type="text" style=" background-color: transparent;   padding-left: 24px;        
             border: 1px solid black;border-left:5px solid red;color:black;" required/>
               <input class="inptcls" id="street" placeholder="Street" name="street" style=" background-color: transparent;  padding-left: 24px;         
             border: 1px solid black;border-left:5px solid red;color:black;" type="text" required />
                <input class="inptcls" id="city" placeholder="City" name="city" type="text" style=" background-color: transparent;  padding-left: 24px;         
             border: 1px solid black;border-left:5px solid  red;color:black;" required/>
                <input class="inptcls" id="state" placeholder="Province" type="text" name="state" style=" background-color: transparent; padding-left: 24px;          
             border: 1px solid black;border-left:5px solid red;color:black;" required />
                <input class="inptcls" id="zip" placeholder="Postal Code" name="zip" type="text" style=" background-color: transparent; padding-left: 24px;          
             border: 1px solid black; border-radius:10px;border-left:5px solid red;color:black;" required/>
          </div>
          <div class="businessname">
            <input id="lead_source" type="hidden" name ="lead_source" value ="Website"/>
            <input id="company" placeholder="Business Name if Applicable" name="company" style="height:50px; background-color: transparent; width:75vw;border:1px solid black; border-radius:10px;padding:10px; padding-left:15px;color:black;" type="text" />
        </div>
           <div class="notes">
  <textarea id="description" placeholder="What can we help you with?" name="description" style="height:100px;background-color:transparent; width:75vw;border-radius:10px;padding:10px;border:1px solid black; padding-left:15px; border-left:5px solid red;color:black;" type="text-area" required></textarea><br>
        </div>
        <div class="submit">
         <!-- please isure your org web to lead recaptcha key pair -->
            <div class="g-recaptcha" data-sitekey="6LcRmQUqAAAAAO_4hu-MPS5FFBqI16baf6vh0Fuf"></div>
            <input class="subBtn" type="submit" label="SUBMIT" name="submit" onclick="webToLead()" placeholder="SUBMIT"style="border-radius:50px;border:1px solid black; height:50px; width:200px;background-color:transparent;">
        </div>
        <div class="error-message" id="error-message"></div>
       </form>
     </div>
</body>
<script src="https://www.google.com/recaptcha/api.js"></script>
<script>
    function webToLead() {
       var response = document.getElementById("g-recaptcha-response").value;   
        if (response.length === 0) {
            var errorMessageElement = document.getElementById("error-message");
            errorMessageElement.textContent = "Please complete the reCAPTCHA.";
            return false;
        } 
        errorMessageElement.textContent = "";
            var form = document.createElement("form");
            form.method = "POST";
            form.action ="https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8&orgId=00DHp000003USyC";
    }
    function timestamp() {
        var response = document.getElementById("g-recaptcha-response");
        if (response == null || response.value.trim() == "") {
            var elems = JSON.parse(document.getElementsByName("captcha_settings")[0].value);
            elems["ts"] = JSON.stringify(new Date().getTime());
            document.getElementsByName("captcha_settings")[0].value = JSON.stringify(elems);
        }
    } 
    setInterval(timestamp, 500);

    
</script>



<!-- Adding autofill addresses -->

<script>
const myAPIKey = "2bdc002ad0d54ea5914f2749d35b9eb0";
const streetInput = new autocomplete.GeocoderAutocomplete(
  document.getElementById("street"),
  myAPIKey, {
    allowNonVerifiedHouseNumber: true,
    allowNonVerifiedStreet: true,
    skipDetails: true,
    skipIcons: true,
    placeholder: " "
  });

const stateInput = new autocomplete.GeocoderAutocomplete(
  document.getElementById("state"),
  myAPIKey, {
    type: "state",
    skipDetails: true,
    placeholder: " ",
    skipIcons: true
  });

const cityInput = new autocomplete.GeocoderAutocomplete(
  document.getElementById("city"),
  myAPIKey, {
    type: "city",
    skipDetails: true,
    skipIcons: true,
    placeholder: " "
  });


const postcodeElement = document.getElementById("zip");


streetInput.on('select', (street) => {
  if (street) {
    streetInput.setValue(street.properties.street || '');
  }

  if (street && street.properties.housenumber) {
    housenumberElement.value = street.properties.housenumber;
  }

  if (street && street.properties.zip) {
    postcodeElement.value = street.properties.zip;
  }

  if (street && street.properties.city) {
    cityInput.setValue(street.properties.city);
  }

  if (street && street.properties.state) {
    stateInput.setValue(street.properties.state);
  }

});

cityInput.on('select', (city) => {

  if (city) {
    cityInput.setValue(city.properties.city || '');
  }

  if (city && city.properties.zip) {
    postcodeElement.value = city.properties.zip;
  }

  if (city && city.properties.state) {
    stateInput.setValue(city.properties.state);
  }

});

stateInput.on('select', (state) => {

  if (state) {
    stateInput.setValue(state.properties.state || '');
  }

});

function checkAddress() {
  const postcode = document.getElementById("zip").value;;
  const city = cityInput.getValue();
  const street = streetInput.getValue();
  const state = stateInput.getValue();
 

  const message = document.getElementById("message");
  message.textContent = "";

  if (!postcode|| !city || !street  || !state ) {
    highlightEmpty();
    message.textContent = "Please fill in the required fields and check your address again.";
    return;
  }

  // Check the address with Geoapify Geocoding API
  // You may use it for internal information only. Please note that house numbers might be missing for new buildings and non-mapped buildings. So consider that most addresses with verified streets and cities are correct.
  fetch(`https://api.geoapify.com/v1/geocode/search?&street=${encodeURIComponent(street)}&postcode=${encodeURIComponent(zip)}&city=${encodeURIComponent(city)}&state=${encodeURIComponent(state)}}&apiKey=${myAPIKey}`).then(result => result.json()).then((result) => {
    let features = result.features || [];

    const confidenceLevelToAccept = 0.25;
    features = features.filter(feature => feature.properties.rank.confidence >= confidenceLevelToAccept);

    if (features.length) {
      const foundAddress = features[0];
      if (foundAddress.properties.rank.confidence === 1) {
        message.textContent = `We verified the address you entered. The formatted address is: ${foundAddress.properties.formatted}`;
      } else if (foundAddress.properties.rank.confidence > 0.5 && foundAddress.properties.rank.confidence_street_level === 1) {
        message.textContent = `We have some doubts about the accuracy of the address: ${foundAddress.properties.formatted}`
      } else if (foundAddress.properties.rank.confidence_street_level === 1) {
        message.textContent = `We can confirm the address up to street level: ${foundAddress.properties.formatted}`
      } else {
        message.textContent = `We can only verify your address partially. The address we found is ${foundAddress.properties.formatted}`
      }
    } else {
      message.textContent = "We cannot find your address. Please check if you provided the correct address."
    }
  });
}


function highlightEmpty() {
  const toHightlight = [];

  if (!document.getElementById("zip").value) {
    toHightlight.push(document.getElementById("zip"));
  }

  if (!cityInput.getValue()) {
    toHightlight.push(cityInput.inputElement);
  }

  if (!streetInput.getValue()) {
    toHightlight.push(streetInput.inputElement);
  }


  if (!stateInput.getValue()) {
    toHightlight.push(stateInput.inputElement);
  }


  toHightlight.forEach(element => element.classList.add("warning-input"));

  setTimeout(() => {
    toHightlight.forEach(element => element.classList.remove("warning-input"));
  }, 3000);
}

</script>
</html>
